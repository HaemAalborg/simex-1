<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Misclassification in models using MCSIMEX — mcsimex • simex</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Misclassification in models using MCSIMEX — mcsimex" />

<meta property="og:description" content="Implementation of the misclassification MCSIMEX algorithm as described by Küchenhoff, Mwalili and Lesaffre." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simex</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/wolfganglederer/simex">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Misclassification in models using MCSIMEX</h1>
    <small class="dont-index">Source: <a href='https://github.com/wolfganglederer/simex/blob/master/R/mcsimex.R'><code>R/mcsimex.R</code></a></small>
    <div class="hidden name"><code>mcsimex.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Implementation of the misclassification MCSIMEX algorithm as described by Küchenhoff, Mwalili and Lesaffre.</p>
    
    </div>

    <pre class="usage"><span class='fu'>mcsimex</span>(<span class='no'>model</span>, <span class='no'>SIMEXvariable</span>, <span class='no'>mc.matrix</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.5</span>, <span class='fl'>2</span>),
  <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>fitting.method</span> <span class='kw'>=</span> <span class='st'>"quadratic"</span>,
  <span class='kw'>jackknife.estimation</span> <span class='kw'>=</span> <span class='st'>"quadratic"</span>, <span class='kw'>asymptotic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># S3 method for mcsimex</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/expression'>expression</a></span>((<span class='fl'>1</span> + <span class='no'>lambda</span>)),
  <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>b</span>[, -<span class='fl'>1</span>]), <span class='kw'>ask</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>show</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>TRUE</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>NCOL</a></span>(<span class='no'>b</span>) -
  <span class='fl'>1</span>), <span class='no'>...</span>)

<span class='co'># S3 method for mcsimex</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/predict'>predict</a></span>(<span class='no'>object</span>, <span class='no'>newdata</span>, <span class='no'>...</span>)

<span class='co'># S3 method for mcsimex</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>x</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>max</a></span>(<span class='fl'>3</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/options'>getOption</a></span>(<span class='st'>"digits"</span>) - <span class='fl'>3</span>), <span class='no'>...</span>)

<span class='co'># S3 method for summary.mcsimex</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>x</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>max</a></span>(<span class='fl'>3</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/options'>getOption</a></span>(<span class='st'>"digits"</span>) -
  <span class='fl'>3</span>), <span class='no'>...</span>)

<span class='co'># S3 method for mcsimex</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S3 method for mcsimex</span>
<span class='fu'><a href='simex.html'>refit</a></span>(<span class='no'>object</span>, <span class='kw'>fitting.method</span> <span class='kw'>=</span> <span class='st'>"quadratic"</span>,
  <span class='kw'>jackknife.estimation</span> <span class='kw'>=</span> <span class='st'>"quadratic"</span>, <span class='kw'>asymptotic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>the naive model, the misclassified variable must be a factor</p></td>
    </tr>
    <tr>
      <th>SIMEXvariable</th>
      <td><p>vector of names of the variables for which the MCSIMEX-method should be applied</p></td>
    </tr>
    <tr>
      <th>mc.matrix</th>
      <td><p>if one variable is misclassified it can be a matrix. If more
than one variable is misclassified it must be a list of the misclassification
matrices, names must match with the SIMEXvariable names, column- and row-names
must match with the factor levels. If a special misclassification is desired,
the name of a function can be specified (see details)</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>vector of exponents for the misclassification matrix (without 0)</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>number of iterations for each lambda</p></td>
    </tr>
    <tr>
      <th>fitting.method</th>
      <td><p><code>linear</code>, <code>quadratic</code> and <code>loglinear</code>
are implemented (first 4 letters are enough)</p></td>
    </tr>
    <tr>
      <th>jackknife.estimation</th>
      <td><p>specifying the extrapolation method for jackknife
variance estimation. Can be set to <code>FALSE</code> if it should not be performed</p></td>
    </tr>
    <tr>
      <th>asymptotic</th>
      <td><p>logical, indicating if asymptotic variance estimation should
be done, the option <code>x = TRUE</code> must be enabled in the naive model</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>object of class 'mcsimex'</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>optional name for the X-Axis</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>vector containing the names for the Y-Axis</p></td>
    </tr>
    <tr>
      <th>ask</th>
      <td><p>ogical. If <code>TRUE</code>, the user is asked for input, before a new figure is drawn</p></td>
    </tr>
    <tr>
      <th>show</th>
      <td><p>vector of logicals indicating for which variables a plot should be produced</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>arguments passed to other functions</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>object of class 'mcsimex'</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>optionally, a data frame in which to look for variables with
which to predict. If omitted, the fitted linear predictors are used</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>number of digits to be printed</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class 'mcsimex' which contains:</p>
<dt>coefficients</dt><dd><p>corrected coefficients of the MCSIMEX model,</p></dd>
<dt>SIMEX.estimates</dt><dd><p>the MCSIMEX-estimates of the coefficients for each lambda,</p></dd>
<dt>lambda</dt><dd><p>the values of lambda,</p></dd>
<dt>model</dt><dd><p>the naive model,</p></dd>
<dt>mc.matrix</dt><dd><p>the misclassification matrix,</p></dd>
<dt>B</dt><dd><p>the number of iterations,</p></dd>
<dt>extrapolation</dt><dd><p>the model object of the extrapolation step,</p></dd>
<dt>fitting.method</dt><dd><p>the fitting method used in the extrapolation step,</p></dd>
<dt>SIMEXvariable</dt><dd><p>name of the SIMEXvariables,</p></dd>
<dt>call</dt><dd><p>the function call,</p></dd>
<dt>variance.jackknife</dt><dd><p>the jackknife variance estimates,</p></dd>
<dt>extrapolation.variance</dt><dd><p>the model object of the variance extrapolation,</p></dd>
<dt>variance.jackknife.lambda</dt><dd><p>the data set for the extrapolation,</p></dd>
<dt>variance.asymptotic</dt><dd><p>the asymptotic variance estimates,</p></dd>
<dt>theta</dt><dd><p>all estimated coefficients for each lambda and B,</p></dd>
...

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If <code>mc.matrix</code> is a function the first argument of that function must
be the whole dataset used in the naive model, the second argument must be
the exponent (lambda) for the misclassification. The function must return
a <code>data.frame</code> containing the misclassified <code>SIMEXvariable</code>. An
example can be found below.</p>
<p>Asymptotic variance estimation is only implemented for <code>lm</code> and <code>glm</code></p>
<p>The loglinear fit has the form <code>g(lambda, GAMMA) = exp(gamma0 + gamma1 * lambda)</code>.
It is realized via the <code><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log()</a></code> function. To avoid negative values the
minimum +1 of the dataset is added and after the prediction later substracted
<code>exp(predict(...)) - min(data) - 1</code>.</p>
<p>The 'log2' fit is fitted via the <code><a href='https://www.rdocumentation.org/packages/stats/topics/nls'>nls()</a></code> function for direct fitting of
the model <code>y ~ exp(gamma.0 + gamma.1 * lambda)</code>. As starting values the
results of a LS-fit to a linear model with a log transformed response are used.
If <code>nls</code> does not converge, the model with the starting values is returned.</p>
<p><code><a href='simex.html'>refit()</a></code> refits the object with a different extrapolation function.</p>
    
    <h2 class="hasAnchor" id="methods-by-generic-"><a class="anchor" href="#methods-by-generic-"></a>Methods (by generic)</h2>

    <ul>
<li><p><code>plot</code>: Plots of the simulation and extrapolation</p></li>
<li><p><code>predict</code>: Predict with mcsimex correction</p></li>
<li><p><code>print</code>: Nice printing</p></li>
<li><p><code>print</code>: Print summary nicely</p></li>
<li><p><code>summary</code>: Summary for mcsimex</p></li>
<li><p><code>refit</code>: Refits the model with a different extrapolation function</p></li>
</ul>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Küchenhoff, H., Mwalili, S. M.  and Lesaffre, E. (2006) A general method for
dealing with misclassification in regression: The Misclassification SIMEX.
<em>Biometrics</em>, <b>62</b>, 85 -- 96</p>
<p>Küchenhoff, H., Lederer, W. and E. Lesaffre. (2006) Asymptotic Variance Estimation
for the Misclassification SIMEX.
<em>Computational Statistics and Data Analysis</em>, <b>51</b>, 6197 -- 6211</p>
<p>Lederer, W. and Küchenhoff, H. (2006) A short introduction to the SIMEX and MCSIMEX. <em>R News</em>, <b>6(4)</b>, 26--31</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='misclass.html'>misclass</a></code>, <code><a href='simex.html'>simex</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>200</span>, <span class='fl'>0</span>, <span class='fl'>1.142</span>)
<span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>200</span>, <span class='fl'>0</span>, <span class='fl'>2</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Binomial'>rbinom</a></span>(<span class='fl'>200</span>, <span class='fl'>1</span>, (<span class='fl'>1</span> / (<span class='fl'>1</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>exp</a></span>(-<span class='fl'>1</span> * (-<span class='fl'>2</span> + <span class='fl'>1.5</span> * <span class='no'>x</span> -<span class='fl'>0.5</span> * <span class='no'>z</span>))))))
<span class='no'>Pi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.9</span>, <span class='fl'>0.1</span>, <span class='fl'>0.3</span>, <span class='fl'>0.7</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/dimnames'>dimnames</a></span>(<span class='no'>Pi</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>y</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>y</span>))
<span class='no'>ystar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='misclass.html'>misclass</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='no'>y</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>Pi</span>), <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>1</span>)[, <span class='fl'>1</span>]
<span class='no'>naive.model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></span>(<span class='no'>ystar</span> ~ <span class='no'>x</span> + <span class='no'>z</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>binomial</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>true.model</span>  <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/glm'>glm</a></span>(<span class='no'>y</span> ~ <span class='no'>x</span> + <span class='no'>z</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='no'>binomial</span>)
<span class='no'>simex.model</span> <span class='kw'>&lt;-</span> <span class='fu'>mcsimex</span>(<span class='no'>naive.model</span>, <span class='kw'>mc.matrix</span> <span class='kw'>=</span> <span class='no'>Pi</span>, <span class='kw'>SIMEXvariable</span> <span class='kw'>=</span> <span class='st'>"ystar"</span>)

<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>3</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/invisible'>invisible</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='no'>simex.model</span>$<span class='no'>theta</span>, <span class='no'>boxplot</span>, <span class='kw'>notch</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>outline</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                 <span class='kw'>names</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.5</span>, <span class='fl'>1</span>, <span class='fl'>1.5</span>, <span class='fl'>2</span>)))
                 <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>simex.model</span>)</div><div class='img'><img src='mcsimex-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>simex.model2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simex.html'>refit</a></span>(<span class='no'>simex.model</span>, <span class='st'>"line"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>simex.model2</span>)</div><div class='img'><img src='mcsimex-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='no'>op</span>)

<span class='co'># example using polr from the MASS package</span></div><span class='co'># NOT RUN {</span>
<span class='kw'>if</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>MASS</span>)) {
  <span class='no'>yord</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cut'>cut</a></span>((<span class='fl'>1</span> / (<span class='fl'>1</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>exp</a></span>(-<span class='fl'>1</span> * (-<span class='fl'>2</span> + <span class='fl'>1.5</span> * <span class='no'>x</span> -<span class='fl'>0.5</span> * <span class='no'>z</span>)))), <span class='fl'>3</span>, <span class='kw'>ordered</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
  <span class='no'>Pi3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.8</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.2</span>, <span class='fl'>0.7</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.2</span>, <span class='fl'>0.7</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/dimnames'>dimnames</a></span>(<span class='no'>Pi3</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>yord</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>yord</span>))
  <span class='no'>ystarord</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='misclass.html'>misclass</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='no'>yord</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>yord</span> <span class='kw'>=</span> <span class='no'>Pi3</span>), <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>1</span>)[, <span class='fl'>1</span>]
  <span class='no'>naive.ord.model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/MASS/topics/polr'>polr</a></span>(<span class='no'>ystarord</span> ~ <span class='no'>x</span> + <span class='no'>z</span>, <span class='kw'>Hess</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
  <span class='no'>simex.ord.model</span> <span class='kw'>&lt;-</span> <span class='fu'>mcsimex</span>(<span class='no'>naive.ord.model</span>, <span class='kw'>mc.matrix</span> <span class='kw'>=</span> <span class='no'>Pi3</span>,
      <span class='kw'>SIMEXvariable</span> <span class='kw'>=</span> <span class='st'>"ystarord"</span>, <span class='kw'>asymptotic</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
}
<span class='co'># }</span><div class='input'>
# example for a function which can be supplied to the function mcsimex()
# "ystar" is the variable which is to be misclassified
# using the example above
</div><span class='co'># NOT RUN {</span>
<span class='no'>my.misclass</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span> (<span class='no'>datas</span>, <span class='no'>k</span>) {
    <span class='no'>ystar</span> <span class='kw'>&lt;-</span> <span class='no'>datas</span>$<span class='st'>"ystar"</span>
    <span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.75</span>, <span class='fl'>0.25</span>, <span class='fl'>0.25</span>, <span class='fl'>0.75</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>p1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>ystar</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>rownames</a></span>(<span class='no'>p1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>ystar</span>)
    <span class='no'>p0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.8</span>, <span class='fl'>0.2</span>, <span class='fl'>0.2</span>, <span class='fl'>0.8</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>p0</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>ystar</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>rownames</a></span>(<span class='no'>p0</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/levels'>levels</a></span>(<span class='no'>ystar</span>)
    <span class='no'>ystar</span>[<span class='no'>datas</span>$<span class='no'>x</span> <span class='kw'>&lt;</span> <span class='fl'>0</span>] <span class='kw'>&lt;-</span>
    <span class='fu'><a href='misclass.html'>misclass</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='kw'>ystar</span> <span class='kw'>=</span> <span class='no'>ystar</span>[<span class='no'>datas</span>$<span class='no'>x</span> <span class='kw'>&lt;</span> <span class='fl'>0</span>]), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>ystar</span> <span class='kw'>=</span> <span class='no'>p1</span>), <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>k</span>)[, <span class='fl'>1</span>]
    <span class='no'>ystar</span>[<span class='no'>datas</span>$<span class='no'>x</span> <span class='kw'>&gt;</span> <span class='fl'>0</span>] <span class='kw'>&lt;-</span>
    <span class='fu'><a href='misclass.html'>misclass</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='kw'>ystar</span> <span class='kw'>=</span> <span class='no'>ystar</span>[<span class='no'>datas</span>$<span class='no'>x</span> <span class='kw'>&gt;</span> <span class='fl'>0</span>]), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>ystar</span> <span class='kw'>=</span> <span class='no'>p0</span>), <span class='kw'>k</span> <span class='kw'>=</span> <span class='no'>k</span>)[, <span class='fl'>1</span>]
    <span class='no'>ystar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='no'>ystar</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/function'>return</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='no'>ystar</span>))}

<span class='no'>simex.model.differential</span> <span class='kw'>&lt;-</span> <span class='fu'>mcsimex</span>(<span class='no'>naive.model</span>, <span class='kw'>mc.matrix</span> <span class='kw'>=</span> <span class='st'>"my.misclass"</span>, <span class='kw'>SIMEXvariable</span> <span class='kw'>=</span> <span class='st'>"ystar"</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#methods-by-generic-">Methods (by generic)</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Wolfgang Lederer, <a href='mailto:wolfgang.lederer@gmail.com'>wolfgang.lederer@gmail.com</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Wolfgang Lederer, Heidi Seibold.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

